#!/usr/bin/env tracebox -s

function cb(ttl, pkt, reply, mods)
	if ttl == 1 then
		print("luatracebox to " .. pkt:dest())
	end
	
	if reply and mods then
		print(ttl, reply:source(), mods)
	elseif reply then
		print(ttl, reply:source())
	else
		print(ttl, '*')
	end
end

tracebox(IP / TCP, {callback = "cb"})
